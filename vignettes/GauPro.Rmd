---
title: "A Guide to the GauPro R package"
author: "Collin Erickson"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{A Guide to the GauPro R package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


This R package provides R code for fitting Gaussian process models to data.
The code is created using the `R6` class structure, which is why `$` is used to access object methods.

A Gaussian process fits a model to a dataset, which gives a function that gives a prediction for the mean at any point along with a variance of this prediction.

Suppose we have the data below

```{r}
x <- seq(0,1,l=10)
y <- abs(sin(2*pi*x))^.8
plot(x, y)
```

A linear model (LM) will fit a straight line through the data and clearly does not describe the underlying function producing the data.

```{r}
lm_mod <- lm(y ~ x)
plot(x, y)
abline(a=lm_mod$coef[1], b=lm_mod$coef[2], col='red')
```

A Gaussian process is a type of model that assumes that the distribution of points
follows a multivariate distribution.

In GauPro, we can fit a GP model with Gaussian correlation function using
the function ``

```{r}
library(GauPro)
gp <- GauPro(x, y, parallel=FALSE)
```

Now we can plot the predictions given by the model.
Shown below, this model looks much better than a linear model.

```{r}
plot(x, y)
curve(gp$predict(x), add=T, col=2)
```

A very useful property of GP's is that they give a predicted error.
The blue lines give an approximate 95% confidence interval.
The width of the prediction interval is largest between points
and goes to zero near data points, which is what we would hope for.

```{r}
plot(x, y)
curve(gp$predict(x), add=T, col=2)
curve(gp$predict(x)+2*gp$predict(x, se=T)$se, add=T, col=4)
curve(gp$predict(x)-2*gp$predict(x, se=T)$se, add=T, col=4)
```

GP models give distributions for the predictions.
Realizations from these distributions give an idea of
what the true function may look like.
Calling `plot` on the 1-D gp object shows 20 realizations.
There is no visible difference between the data points,
only at the ends.

```{r}
plot(gp)
```

